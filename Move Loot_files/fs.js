try{"undefined"===typeof WeakMap&&function(){var h=Object.defineProperty,z=Date.now()%1E9,a=function(){this.name="__st"+(1E9*Math.random()>>>0)+(z++ +"__")};a.prototype={set:function(a,e){var d=a[this.name];d&&d[0]===a?d[1]=e:h(a,this.name,{value:[a,e],writable:!0})},get:function(a){var e;return(e=a[this.name])&&e[0]===a?e[1]:void 0}};window.WeakMap=a}()}catch(e$$12){};try{(function(h){function z(){m=!1;var b=q;q=[];b.sort(function(a,b){return a.uid_-b.uid_});var c=!1;b.forEach(function(b){var k=b.takeRecords();a(b);k.length&&(b.callback_(k,b),c=!0)});c&&z()}function a(a){a.nodes_.forEach(function(b){(b=f.get(b))&&b.forEach(function(b){b.observer===a&&b.removeTransientObservers()})})}function g(a,b){for(var c=a;c;c=c.parentNode){var k=f.get(c);if(k)for(var d=0;d<k.length;d++){var p=k[d],l=p.options;(c===a||l.subtree)&&(l=b(l))&&p.enqueue(l)}}}function e(a){this.callback_=
a;this.nodes_=[];this.records_=[];this.uid_=++t}function d(a,b){this.type=a;this.target=b;this.addedNodes=[];this.removedNodes=[];this.oldValue=this.attributeNamespace=this.attributeName=this.nextSibling=this.previousSibling=null}function b(a,b){return s=new d(a,b)}function c(a){if(v)return v;var b=s,c=new d(b.type,b.target);c.addedNodes=b.addedNodes.slice();c.removedNodes=b.removedNodes.slice();c.previousSibling=b.previousSibling;c.nextSibling=b.nextSibling;c.attributeName=b.attributeName;c.attributeNamespace=
b.attributeNamespace;c.oldValue=b.oldValue;v=c;v.oldValue=a;return v}function k(a,b,c){this.observer=a;this.target=b;this.options=c;this.transientObservedNodes=[]}var f=new WeakMap,p=window.msSetImmediate;if(!p){var l=[],w=String(Math.random());window.addEventListener("message",function(a){a.data===w&&(a=l,l=[],a.forEach(function(a){a()}))});p=function(a){l.push(a);window.postMessage(w,"*")}}var m=!1,q=[],t=0;e.prototype={observe:function(a,b){a=window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(a)||
a;if(!b.childList&&!b.attributes&&!b.characterData||b.attributeOldValue&&!b.attributes||b.attributeFilter&&b.attributeFilter.length&&!b.attributes||b.characterDataOldValue&&!b.characterData)throw new SyntaxError;var c=f.get(a);c||f.set(a,c=[]);for(var d,p=0;p<c.length;p++)if(c[p].observer===this){d=c[p];d.removeListeners();d.options=b;break}d||(d=new k(this,a,b),c.push(d),this.nodes_.push(a));d.addListeners()},disconnect:function(){this.nodes_.forEach(function(a){a=f.get(a);for(var b=0;b<a.length;b++){var c=
a[b];if(c.observer===this){c.removeListeners();a.splice(b,1);break}}},this);this.records_=[]},takeRecords:function(){var a=this.records_;this.records_=[];return a}};var s,v;k.prototype={enqueue:function(a){var b=this.observer.records_,c=b.length;if(0<b.length){var k=b[c-1];k=k===a?k:!v||k!==v&&k!==s?null:v;if(k){b[c-1]=k;return}}else q.push(this.observer),m||(m=!0,p(z));b[c]=a},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(a){var b=this.options;b.attributes&&a.addEventListener("DOMAttrModified",
this,!0);b.characterData&&a.addEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.addEventListener("DOMNodeInserted",this,!0);(b.childList||b.subtree)&&a.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(a){var b=this.options;b.attributes&&a.removeEventListener("DOMAttrModified",this,!0);b.characterData&&a.removeEventListener("DOMCharacterDataModified",this,!0);b.childList&&a.removeEventListener("DOMNodeInserted",
this,!0);(b.childList||b.subtree)&&a.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(a){if(a!==this.target){this.addListeners_(a);this.transientObservedNodes.push(a);var b=f.get(a);b||f.set(a,b=[]);b.push(this)}},removeTransientObservers:function(){var a=this.transientObservedNodes;this.transientObservedNodes=[];a.forEach(function(a){this.removeListeners_(a);a=f.get(a);for(var b=0;b<a.length;b++)if(a[b]===this){a.splice(b,1);break}},this)},handleEvent:function(a){switch(a.type){case "DOMAttrModified":var k=
a.attrName,d=a.relatedNode.namespaceURI,f=a.target,p=new b("attributes",f);p.attributeName=k;p.attributeNamespace=d;var l=a.attrChange===MutationEvent.ADDITION?null:a.prevValue;g(f,function(a){if(a.attributes&&(!a.attributeFilter||!a.attributeFilter.length||-1!==a.attributeFilter.indexOf(k)||-1!==a.attributeFilter.indexOf(d)))return a.attributeOldValue?c(l):p});break;case "DOMCharacterDataModified":f=a.target;p=b("characterData",f);l=a.prevValue;g(f,function(a){if(a.characterData)return a.characterDataOldValue?
c(l):p});break;case "DOMNodeRemoved":this.addTransientObserver(a.target);case "DOMNodeInserted":var f=a.relatedNode,e=a.target,w;"DOMNodeInserted"===a.type?(a=[e],w=[]):(a=[],w=[e]);var m=e.previousSibling,e=e.nextSibling,p=b("childList",f);p.addedNodes=a;p.removedNodes=w;p.previousSibling=m;p.nextSibling=e;g(f,function(a){if(a.childList)return p})}s=v=void 0}};h.JsMutationObserver=e;!h.MutationObserver&&h.WebKitMutationObserver&&(h.MutationObserver=h.WebKitMutationObserver);h.MutationObserver||(h.MutationObserver=
e)})(this)}catch(e$$15){};(function(){var h;(function(a){a.EVENT_MUT_INSERT=2;a.EVENT_MUT_REMOVE=3;a.EVENT_MUT_ATTR=4;a.EVENT_MUT_ATTR_CURVE=5;a.EVENT_MUT_TEXT=6;a.EVENT_MUT_SKIPIDS=7;a.EVENT_MOUSEMOVE=8;a.EVENT_MOUSEMOVE_CURVE=9;a.EVENT_SCROLL=10;a.EVENT_SCROLL_CURVE=11;a.EVENT_MOUSEDOWN=12;a.EVENT_MOUSEUP=13;a.EVENT_KEYDOWN=14;a.EVENT_KEYUP=15;a.EVENT_CLICK=16;a.EVENT_FOCUS=17;a.EVENT_VALUECHANGE=18;a.EVENT_RESIZE=19;a.EVENT_DOMLOADED=20;a.EVENT_LOAD=21;a.EVENT_PLACEHOLDER_SIZE=22;a.EVENT_UNLOAD=23;a.EVENT_BLUR=24;a.EVENT_SET_FRAME_BASE=
25;a.EVENT_TOUCHSTART=32;a.EVENT_TOUCHEND=33;a.EVENT_TOUCHCANCEL=34;a.EVENT_TOUCHMOVE=35;a.EVENT_TOUCHMOVE_CURVE=36;a.EVENT_NAVIGATE=37;a.EVENT_PLAY=38;a.EVENT_PAUSE=39;a.EVENT_INNERWIDTH=40;a.EVENT_INNERWIDTH_CURVE=41;a.EVENT_LOG=48;a.EVENT_ERROR=49;a.EVENT_DBL_CLICK=50;a.EVENT_FORM_SUBMIT=51;a.EVENT_WINDOW_FOCUS=52;a.EVENT_WINDOW_BLUR=53;a.EVENT_HEARTBEAT=54;a.EVENT_SYS_SETMETA=8192;a.EVENT_SYS_SETVAR=8193;a.EVENT_SYS_HIGHLIGHT=8194;a.EVENT_COOKED_LOAD="load";a.EVENT_COOKED_UNLOAD="unload";a.EVENT_COOKED_NAVIGATE=
"navigate";a.EVENT_COOKED_CLICK="click";a.EVENT_COOKED_FOCUS="focus";a.EVENT_COOKED_CHANGE="change";a.EVENT_COOKED_MOUSE_THRASH="thrash";a.isUserActionEvent=function(g){switch(g){case a.EVENT_MOUSEDOWN:case a.EVENT_MOUSEMOVE:case a.EVENT_MOUSEMOVE_CURVE:case a.EVENT_MOUSEUP:case a.EVENT_KEYDOWN:case a.EVENT_KEYUP:case a.EVENT_TOUCHSTART:case a.EVENT_TOUCHEND:case a.EVENT_TOUCHMOVE:case a.EVENT_TOUCHMOVE_CURVE:case a.EVENT_TOUCHCANCEL:case a.EVENT_CLICK:case a.EVENT_SCROLL:case a.EVENT_SCROLL_CURVE:case a.EVENT_NAVIGATE:return!0}return!1};
a.MAX_LOGS_PER_PAGE=1024})(h||(h={}));(function(a){function g(d){a.log("debug",d)}var e;a.$entry=function(a){return a&&a.apply?function(){try{return a.apply(this,arguments)}catch(b){g(b+"")}}:(g("cannot wrap in $entry without apply"),a)};a.logIfDebug=function(d){a.isDebug()&&window.console&&console.log(d)};a.logFSError=g;a.stringify=function(a){var b=Array.prototype.toJSON,c=String.prototype.toJSON;try{return e||(e=window.JSON),b&&delete Array.prototype.toJSON,c&&delete String.prototype.toJSON,void 0===
a?'"undefined"':a&&a.constructor==Date?isNaN(a)?'"Invalid Date"':'"'+a.toUTCString()+'"':e.stringify(a)}catch(k){return'"TypeError: JSON.stringify cannot serialize cyclic structures"'}finally{b&&(Array.prototype.toJSON=b),c&&(String.prototype.toJSON=c)}};a.parseJson=function(a){e||(e=window.JSON);return e.parse(a)}})(h||(h={}));(function(a){var g=function(){function a(b,c){this.parent=b;this.combinator=c;this.classes={};this.attrs={};this.attrMatch={}}a.prototype.cssEscapeIdent=function(a){var c=
function(a){return-1!="[]:./\\()@#%^&*'\" ".indexOf(a)?"\\"+a:"\\"+a.charCodeAt(0).toString(16)+" "};return"-"==a?"\\-":"-"==a[0]?"-"+a.slice(1).replace(/([^0-9a-zA-Z-_])/g,c):a.replace(/[^0-9a-zA-Z-_]/g,c)};a.prototype.cssEscapeString=function(a){return'"'+a.replace(/[\x01-\x1f\"\\]/g,function(a){return'"'==a||"\\"==a?"\\"+a:"\\"+a.charCodeAt(0).toString(16)+" "})+'"'};a.prototype.serialize=function(){var a=this.combinator?this.combinator:"";this.tag&&(a+="*"==this.tag?this.tag:this.cssEscapeIdent(this.tag));
this.id&&(a+="#"+this.cssEscapeIdent(this.id));var c=Object.keys(this.classes);c.sort();for(var k=0;k<c.length;k++)a+="."+this.cssEscapeIdent(c[k]);for(var f in this.attrs)a+="["+this.cssEscapeIdent(f)+this.attrMatch[f]+this.cssEscapeString(this.attrs[f])+"]";return a};return a}();a.SelectorRule=g;var e=function(){function a(b){this.rules=b}a.parse=function(b,c){void 0===c&&(c=null);b=b.trim();var k=new g(null,null),f=0,p=!1,l=function(){throw"Invalid selector";},e=function(){r=b[++f];if("\n"==r||
null==r)throw l();if(r.match(/[0-9a-fA-F]/)){var a="";do a+=r,r=b[++f];while(r&&r.match(/[0-9a-fA-F]/));r&&r.match(/[\s]/)&&f++;return String.fromCharCode(parseInt(a,16))}f++;return r},m=function(){for(var a=f,c="",k;null!=(k=b[f]);)if("\\"==k)c+=e();else if(k.match(/[a-zA-Z0-9_\-]/)||128<k.charCodeAt(0))c+=k,f++;else break;if(a==f)throw l();return c},q=function(){for(;null!=b[f]&&b[f].match(/\s/);)f++},h=function(){p=!0;f++;var a=m().toLowerCase(),d;q();d=b[f];var g="=";if("*"==d||"|"==d||"^"==d||
"$"==d||"~"==d)g=d+"=",f++;if(c&&!c[g])throw l();if("="!=b[f])throw l();f++;q();d=g;r=b[f];'"'==r||"'"==r?(g=r,f++):g="]";for(var s="";(r=b[f])!=g;){if(null==r)throw l();if("\\"==r)s+=e();else{if("]"==g&&('"'==r||"'"==r))throw l();s+=r;f++}}f++;"]"!=g&&"]"==b[f]&&f++;k.attrs[a]=s;k.attrMatch[a]=d},s=function(){if(!p)throw l();p=!1;q();var a=b[f];">"==a||"+"==a||"~"==a?(f++,q()):a=" ";k=new g(k,a);if(c&&!c[a])throw l();};if(0==b.indexOf("//"))throw l();for(var v=0,f=0;f<b.length;){if(v++>2*b.length)throw console.log("Likely caught in an infinite loop while parsing "+
b),"Internal error, infinite loop";var r=b[f];switch(r){case "#":p=!0;f++;k.id=m();break;case "*":if(p)throw l();p=!0;k.tag="*";if(c&&!c["*"])throw l();f++;break;case ".":p=!0;f++;k.classes[m()]=!0;break;case "[":h();break;case " ":case ">":case "+":case "~":s();break;case ":":throw l();default:if(p)throw l();p=!0;k.tag=m().toLowerCase()}}if(!p)throw l();return new a(k)};a.prototype.serialize=function(){for(var a=null,c=this.rules;c;c=c.parent)a=a?c.serialize()+a:c.serialize();return a};return a}();
a.Selector=e})(h||(h={}));(function(a){function g(a){var b={};if(!a)return b;if(a.classList)for(var f=0;f<a.classList.length;++f)b[a.classList[f]]=!0;else if(a.className)for(a=(null!=a.className.animVal?a.className.animVal:a.className).split(" "),f=0;f<a.length;++f)b[a[f].trim()]=!0;return b}a.NYI_KIND="nyi";a.BLOCKED_KIND="blocked";a.HIDE_KIND="hide";var e=function(){function a(b,c){this._parent=b;this._rule=c}a.prototype.parent=function(){return this._parent};a.prototype.matches=function(a,b){if(!a||
this._rule.tag&&a.tagName.toLowerCase()!=this._rule.tag||this._rule.id&&a.id!=this._rule.id)return!1;for(var c in this._rule.classes)if(!(c in b))return!1;for(var d in this._rule.attrs)if(a.getAttribute(d)!=this._rule.attrs[d])return!1;return this._parent?this._parent.matches(a.parentElement,g(a.parentElement)):!0};return a}();a.BlockRuleElem=e;var d=function(){function b(c){this.kind=c.Kind;this.selector=a.Selector.parse(c.Selector,{"=":!0,">":!0});var f=function(a){return new e(a.parent?f(a.parent):
null,a)};this.rules=f(this.selector.rules)}b.isComment=function(a){return!!a.match(/^\s*\/\//)};b.prototype.serialize=function(){return this.selector.serialize()};return b}();a.BlockRule=d;var b=function(){function a(){this._rules=[];this.rawRules=[]}a.prototype.isBlocked=function(a){for(var b=g(a),c=0;c<this._rules.length;++c)if(this._rules[c].rules.matches(a,b))return this._rules[c].kind;return null};a.prototype.addRule=function(a){this._rules.push(new d(a));this.rawRules.push(a)};a.prototype.mungeBlockedStyle=
function(a,b){var c=a.getBoundingClientRect(),d=Math.floor(c.width),c=Math.floor(c.height);if("object"==a.tagName.toLowerCase())for(var e=a.children,m=0;m<e.length;m++){var g=e[m];if("embed"==g.tagName.toLowerCase()){e=g.getBoundingClientRect();d=Math.max(d,Math.floor(e.width));c=Math.max(c,Math.floor(e.height));break}}e="";null!=b&&(e=b.trim());0<e.length&&";"!=e.charAt(e.length-1)&&(e+=";");if(0!=d||0!=c)e+="width:"+d+"px;height:"+c+"px;";return e};return a}();a.Blocker=b})(h||(h={}));(function(a){a.Node_ELEMENT_NODE=
1;a.Node_ATTRIBUTE_NODE=2;a.Node_TEXT_NODE=3;a.Node_CDATA_SECTION_NODE=4;a.Node_ENTITY_REFERENCE_NODE=5;a.Node_ENTITY_NODE=6;a.Node_PROCESSING_INSTRUCTION_NODE=7;a.Node_COMMENT_NODE=8;a.Node_DOCUMENT_NODE=9;a.Node_DOCUMENT_TYPE_NODE=10;a.Node_DOCUMENT_FRAGMENT_NODE=11;a.Node_NOTATION_NODE=12;a.XHR_UNSENT=0;a.XHR_OPENED=1;a.XHR_HEADERS_RECEIVED=2;a.XHR_LOADING=3;a.XHR_DONE=4})(h||(h={}));(function(a){function g(a){return"_fsblocked"in a}function e(a,b){a._fsblocked=b}function d(a){return a?a._fs:null}
function b(a){return(a=d(a))?a.id:0}function c(a,b){if(a.attributes&&0<a.attributes.length)for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];b(d.name,d.value)}}a.isBlocked=g;a.blockKind=function(a){return a._fsblocked};a.setBlocked=e;a.mirrorFor=d;a.fsid=b;a.fsidIfNotBlocked=function(a){return g(a)?0:b(a)};var k=function(){function b(a,c){this._ctx=a;this._blocker=c;this._curId=1}b.prototype.curId=function(){return this._curId};b.prototype.tokenizeNode=function(a,b,c,k){var f=this._curId;
try{var e=[],g=this.tokeNode(c,e,k);if(g&&a){var h=d(a),r=d(b);g.parent=h;r==h.child&&(h.child=g);g.next=r;null==r?(g.prev=h.lastChild,h.lastChild=g):g.prev=r.prev;null!=g.prev&&(g.prev.next=g);null!=g.next&&(g.next.prev=g)}return e}catch(A){return this._curId=f,[]}};b.prototype.removeMirror=function(a){a.parent.child==a&&(a.parent.child=a.next);a.parent.lastChild==a&&(a.parent.lastChild=a.prev);a.prev&&(a.prev.next=a.next);a.next&&(a.next.prev=a.prev);a.id=0;a.child&&this.clearIds(a.child)};b.prototype.clearIds=
function(a){a.id=0;a.next&&this.clearIds(a.next);a.child&&this.clearIds(a.child)};b.prototype.tokeNode=function(b,d,k){if("SCRIPT"==b.nodeName||b.nodeType==a.Node_COMMENT_NODE)return null;var f={id:this._curId++,node:b};b._fs=f;var e=b.nodeName;"http://www.w3.org/2000/svg"==b.namespaceURI&&(e="svg:"+e);d.push("<"+e);try{if(this.processBlockedElem(b,d))return f;k&&k(b);c(b,function(a,b){d.push(":"+a);d.push(b)});if(b.firstChild){d.push("[");for(var e=null,g=b.firstChild;g;g=g.nextSibling){var h=this.tokeNode(g,
d,k);h&&(h.parent=f,e?(e.next=h,h.prev=e):f.child=h,e=f.lastChild=h)}d.push("]")}b.nodeType==a.Node_TEXT_NODE&&d.push(b.textContent)}catch(v){}return f};b.prototype.processBlockedElem=function(b,d){var k=this;if(b.nodeType==a.Node_ELEMENT_NODE&&this._blocker){var f=this._blocker.isBlocked(b);if(f){e(b,f);var g,h=!1;c(b,function(a,c){if("class"==a)c+=" _fs_block_"+f,g=!0;else if("style"==a)c=k._blocker.mungeBlockedStyle(b,c),h=!0;else if("value"==a||"checked"==a||"src"==a)return;d.push(":"+a);d.push(c)});
g||(d.push(":class"),d.push("_fs_block_"+f));h||(d.push(":style"),d.push(this._blocker.mungeBlockedStyle(b,"")));return!0}}return!1};return b}();a.NodeEncoder=k})(h||(h={}));(function(a){function g(a,b){var d=Object.getOwnPropertyDescriptor(a.prototype,b);Object.defineProperty(a.prototype,b,{set:function(a){var b=this;setTimeout(function(){c(b)},0);return d.set.call(this,a)},get:function(){return d.get.call(this)}})}function e(a){switch(a.type){case "checkbox":case "radio":return""+a.checked;default:return(a=
a.value)||(a=""),""+a}}var d=function(){function d(b,k){var l=this;this._onchange=b;this._checkElem=k;this._fallback=!1;this._elems={};this._values={};c=function(b){var c=a.fsid(b);if(c&&(b=l._elems[c])){var d=e(b);d!=l._values[c]&&(l._onchange(b),l._values[c]=d)}}}d.prototype.hookEvents=function(){var a;(a=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"))&&a.set?(b||(g(HTMLInputElement,"value"),g(HTMLInputElement,"checked"),g(HTMLSelectElement,"value"),g(HTMLTextAreaElement,"value"),
b=!0),a=!0):a=!1;a||(this._fallback=!0)};d.prototype.addInput=function(b){var c=a.fsid(b);this._elems[c]=b;this._values[c]=e(b);this._values[c]&&this._onchange(b)};d.prototype.invokeGlobalOnChange=function(a){c(a)};d.prototype.tick=function(){if(this._fallback)for(var a in this._elems)if(this._checkElem(this._elems[a])){var b=this._elems[a],c=e(b);c!=this._values[a]&&(this._onchange(b),this._values[a]=c)}else delete this._elems[a],delete this._values[a]};d.prototype._usingFallback=function(){return this._fallback};
d.prototype._trackingElem=function(a){return!!this._elems[a]};return d}();a.InputWatcher=d;var b=!1,c;a.valueOfInputishElem=e})(h||(h={}));(function(a){var g=function(){function a(){this.dict={idx:-1,map:{}};this.startIdx=0}a.prototype.encode=function(a){function b(){k?1<l.length?f.push([k.idx,l.length]):f.push(k.idx):f.push(l[0])}if(0==a.length)return[];for(var c=a[0],k=Object.prototype.hasOwnProperty.call(this.dict.map,c)?this.dict.map[c]:null,f=[],e,l=[c],c=1;c<a.length;c++)if(e=a[c],k&&Object.prototype.hasOwnProperty.call(k.map,
e))l.push(e),k=k.map[e];else{b();var g=this.startIdx+c-l.length;null==k&&(k={idx:g,map:{}},this.dict.map[l[l.length-1]]=k);k.map[e]={idx:g,map:{}};l=[e];k=Object.prototype.hasOwnProperty.call(this.dict.map,e)?this.dict.map[e]:null}b();this.startIdx+=a.length;return f};return a}();a.LZJGWEncoder=g;g=function(){function a(){this._seq=[]}a.prototype.sequence=function(){return this._seq};a.prototype.decode=function(a){for(var b=this._seq.length,c=0;c<a.length;++c){var k=a[c];switch(typeof k){case "string":this._seq.push(k);
break;case "number":this._seq.push(this._seq[k]);break;case "object":for(var f=0;f<k[1];f++)this._seq.push(this._seq[k[0]+f])}}return b};return a}();a.LZJGWDecoder=g})(h||(h={}));(function(a){a.MutationProcessingInterval=250;a.CurveSamplingInterval=142;a.UploadInterval=5E3;a.UserInactivityTimeout=1E4;a.HeartbeatInitial=4E3;a.HeartbeatMax=256E3;a.PageInactivityTimeout=18E5;a.BackoffMax=3E5;a.ScrollSampleInterval=a.MutationProcessingInterval/5})(h||(h={}));(function(a){var g=function(){function a(b){this._interval=
b;this._handle=-1}a.prototype.oneShot=function(a){setTimeout(a,this._interval)};a.prototype.start=function(a){-1==this._handle&&(this._handle=setInterval(a,this._interval))};a.prototype.stop=function(){-1!=this._handle&&(clearInterval(this._handle),this._handle=-1)};return a}(),e=function(){function d(b,c,d,f,e,l){void 0===e&&(e=function(){});void 0===l&&(l=g);this._ctx=b;this._recUrlPrefix=c;this._processor=d;this._mutProvider=f;this._beforeProcessEvents=e;this._tickerFactory=l;this._eventQueue=
[];this._outgoingEventQueue=[];this._bundleQueue=[];this._recordingDisabled=!1;this._backoffTime=this._backoffRetries=0;this._bundleSeq=1;this._lastWhenTime=this._lastPostTime=0;this._lastWhen=-1;this._lastUserAction=0;this._quiescent=!1;this._lastHeartbeat=0;this._heartbeatInterval=a.HeartbeatInitial;this._gotUnload=!1;this._lastBundleTime=b.wallTime();this._sampleCurvesTicker=this.createTicker(a.CurveSamplingInterval);this._processMutationsTicker=this.createTicker(a.MutationProcessingInterval);
this._uploadTicker=this.createTicker(a.UploadInterval)}d.prototype.createTicker=function(a){return new this._tickerFactory(a)};d.prototype.exponentialBackoffMs=function(b,c){var d=Math.min(a.BackoffMax,5E3*Math.pow(2,b));return c?d+0.25*Math.random()*d:d};d.prototype.isErrorFatal=function(a){return 400<=a||202==a?!0:!1};d.prototype.rawQueue=function(){return this._eventQueue};d.prototype.startPipeline=function(){var a=this;this._recordingDisabled||this._pipelineStarted||(this._lastUserAction=this._ctx.now(),
this.processEvents(),this._processMutationsTicker.start(function(){a.processEvents()}),this._sampleCurvesTicker.start(function(){a.processEvents(!0)}),this._ctx.amInsideIFrame()||(this.enqueueAndSendBundle(),this._uploadTicker.start(function(){a.enqueueAndSendBundle()})),this._pipelineStarted=!0)};d.prototype.enqueue=function(a,c){this.enqueueAt(this._ctx.now(),a,c)};d.prototype.enqueueAt=function(b,c,d){this._recordingDisabled||(b<=this._lastWhen&&(b=this._lastWhen+1),this._lastWhen=b,this._eventQueue.push({When:b,
Kind:c,Args:d}),a.isUserActionEvent(c)&&(this._lastUserAction=b))};d.prototype.disableRecording=function(){this._recordingDisabled=!0;this.stopPipeline()};d.prototype.addUnload=function(){this._gotUnload||(this._gotUnload=!0,this.enqueue(a.EVENT_UNLOAD,[]),this.swanSong())};d.prototype.shutdown=function(){this._flush();this.addUnload();this._flush();this.disableRecording()};d.prototype._flush=function(){this.processEvents();this.maybeSendNextBundle()};d.prototype.prequeue=function(a,c){this._recordingDisabled||
this._eventQueue.unshift({When:0,Kind:a,Args:c})};d.prototype.appendToOutgoingQueue=function(a){this._outgoingEventQueue=this._outgoingEventQueue.concat(a)};d.prototype.appendToQueue=function(a){this._eventQueue=this._eventQueue.concat(a)};d.prototype.lastSentEventTime=function(){return this._lastWhenTime};d.prototype.swanSong=function(){if(!this._recordingDisabled&&!this._ctx.amInsideIFrame()&&(this.processEvents(),0<this._outgoingEventQueue.length&&this.enqueueNextBundle(),0<this._bundleQueue.length||
this._pendingBundle)){var b=this._bundleQueue.concat();this._pendingBundle&&b.unshift(this._pendingBundle);a.logIfDebug("Saving "+b.length+" bundles in swan-song.");b={UserId:this._ctx.userId(),SessionId:this._ctx.sessionId(),PageId:this._ctx.pageId(),Bundles:b,PageStartTime:this._ctx.startTime(),LastBundleTime:this._lastBundleTime};try{localStorage.swanSong=a.stringify(b)}catch(c){}}};d.prototype.recoverSwanSong=function(){if(!this._ctx.amInsideIFrame())try{if("swanSong"in localStorage){var b=localStorage.swanSong;
delete localStorage.swanSong;var c=a.parseJson(b);c.Bundles&&c.UserId&&c.SessionId&&c.PageId?0<c.Bundles.length&&(a.logIfDebug("Sending "+c.Bundles.length+" bundles as prior page swan song"),this.sendSwanSongBundles(c.UserId,c.SessionId,c.PageId,c.PageStartTime,c.Bundles,c.LastBundleTime)):a.logIfDebug("Malformed swan song found. Ignoring it.")}}catch(d){a.logIfDebug("Error recovering swan-song: "+d)}};d.prototype.sendSwanSongBundles=function(b,c,d,f,e,l,g){var h=this;void 0===g&&(g=0);var q=null;
1==e.length&&(q=this._ctx.wallTime()-l);q=this.bundleUrl(this._ctx.orgId(),b,c,d,e[0],f,q);this._ctx.post(q,e[0],function(g){a.logIfDebug("Sent "+e[0].Evts.length+" trailing events from last session as Seq "+e[0].Seq);e.shift();0<e.length?h.sendSwanSongBundles(b,c,d,f,e,l):a.logIfDebug("Done with prior page swan song")},function(q){h.isErrorFatal(q)?a.logIfDebug("Fatal error while sending events, giving up"):(a.logIfDebug("Failed to send events from last session, will retry while on this page"),h._lastSwanSongRetryTicker=
h.createTicker(h.exponentialBackoffMs(g,!0)),h._lastSwanSongRetryTicker.oneShot(function(){h.sendSwanSongBundles(b,c,d,f,e,l,g+1)}))})};d.prototype.rebaseIframe=function(b,c){var d=this._ctx.baseUri();0<this._eventQueue.length?this._eventQueue.unshift({When:this._eventQueue[0].When,Kind:a.EVENT_SET_FRAME_BASE,Args:[d,c]}):this.enqueue(a.EVENT_SET_FRAME_BASE,[d,c]);for(var d=0,f=this._eventQueue.length;d<f;d++){var e=this._eventQueue[d],g=e.When+this._ctx.startTime()-b;0>g&&(g=0);e.When=g}};d.prototype.processEvents=
function(b){this._beforeProcessEvents();this._ctx.now()-this._lastUserAction>a.UserInactivityTimeout?this._quiescent||(this._quiescent=!0,this._heartbeatInterval=a.HeartbeatInitial,this._lastHeartbeat=this._ctx.now()):this._quiescent=!1;if((!this._quiescent||this.maybeSendHeartbeat())&&(this._eventQueue.length||this._mutProvider.hasMutations())&&null!=this._ctx.frameId()){var c=this._eventQueue;this._eventQueue=[];c=this._processor.processQueue(c);b||(c=c.concat(this._mutProvider.processMutations()));
this.ensureFrameIds(c);this._ctx.amInsideIFrame()?parent.postMessage(a.FS_IFRAME_EVENTS+a.FS_DELIMITER+a.stringify(c),"*"):void 0!==this._ctx.pageId()&&(this._outgoingEventQueue=this._outgoingEventQueue.concat(c))}};d.prototype.maybeSendHeartbeat=function(){var b=this._ctx.now();return b-this._lastHeartbeat>=this._heartbeatInterval?(this._lastHeartbeat=b,this._heartbeatInterval*=2,this._heartbeatInterval>a.HeartbeatMax&&(this._heartbeatInterval=a.HeartbeatMax),this.enqueue(a.EVENT_HEARTBEAT,[]),!0):
!1};d.prototype.ensureFrameIds=function(a){var c=this._ctx.frameId();if(c)for(var d=this._ctx.parentIds(),f=d&&0<d.length,e=0;e<a.length;++e){var g=a[e];g.FId||(g.FId=c);f&&!g.PIds&&(g.PIds=d)}};d.prototype.enqueueAndSendBundle=function(){this._pendingBundle?this._pendingBundleFailed&&this._sendPendingBundle():0==this._outgoingEventQueue.length?this.maybeSendNextBundle():this.enqueueNextBundle()};d.prototype.enqueueNextBundle=function(){var a={When:this._outgoingEventQueue[0].When,Seq:this._bundleSeq++,
Evts:this._outgoingEventQueue};this._outgoingEventQueue=[];this._bundleQueue.push(a);this.maybeSendNextBundle()};d.prototype.maybeSendNextBundle=function(){this._ctx.pageId()&&(!this._pendingBundle&&0!=this._bundleQueue.length)&&(this._pendingBundle=this._bundleQueue.shift(),this._sendPendingBundle())};d.prototype.bundleUrl=function(a,c,d,f,e,g,h){a=this._recUrlPrefix+"/bundle?OrgId="+a+"&UserId="+c+"&SessionId="+d+"&PageId="+f+"&Seq="+e.Seq;g&&(a+="&PageStartTime="+g);h&&(a+="&DeltaT="+h);return a};
d.prototype._sendPendingBundle=function(){var b=this,c=this._ctx.wallTime();if(!(c<this._backoffTime)){var d=this._pendingBundle;this._pendingBundleFailed=!1;var f=this.bundleUrl(this._ctx.orgId(),this._ctx.userId(),this._ctx.sessionId(),this._ctx.pageId(),d);this._lastPostTime=this._lastBundleTime=c;this._lastWhenTime=d.Evts[d.Evts.length-1].When;this._ctx.post(f,d,function(c){a.logIfDebug("Sent bundle "+d.Seq+" with "+d.Evts.length+" events");b._pendingBundle=null;b._backoffTime=0;b._backoffRetries=
0;b._ctx.wallTime()-b._lastPostTime>a.UploadInterval&&b.maybeSendNextBundle()},function(c){a.logIfDebug("Failed to send events.");b.isErrorFatal(c)?b.stopPipeline():(b._pendingBundleFailed=!0,b._backoffTime=b._lastPostTime+b.exponentialBackoffMs(b._backoffRetries++,!1))})}};d.prototype.stopPipeline=function(){this._pipelineStarted&&(this._sampleCurvesTicker.stop(),this._processMutationsTicker.stop(),this._uploadTicker.stop(),this._eventQueue=[],this._outgoingEventQueue=[],this._bundleQueue=[])};return d}();
a.EventQueue=e})(h||(h={}));(function(a){var g=function(){function e(d,b,c){void 0===c&&(c=function(a,b){});this._ctx=d;this._blocker=b;this._visitor=c;this._sentDomSnapshot=!1;this._records=[];this._lz=new a.LZJGWEncoder;this._encoder=new a.NodeEncoder(d,b)}e.prototype.hasMutations=function(){return!this._sentDomSnapshot||0<this._records.length};e.prototype.hookMutations=function(a){var b=this;void 0===a&&(a=document.documentElement);this._root=a;this._sentDomSnapshot=!1;(new window.MutationObserver(function(a){b._records=
b._records.concat(a)})).observe(a,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})};e.prototype.processMutations=function(){var d=this._ctx.now(),b=[];this._sentDomSnapshot||(this.genInsert(d,b,null,this._root,null),this._sentDomSnapshot=!0);if(0==this._records.length)return b;var c={},k={};this.processRecords(d,b,k,c);for(var f in k){var e=f.split(":");b.push({Kind:a.EVENT_MUT_ATTR,When:d,Args:[parseInt(e[0]),e[1],k[f]]})}for(f in c)b.push({Kind:a.EVENT_MUT_TEXT,
When:d,Args:[parseInt(f),c[f]]});this._records=[];return b};e.prototype.processRecords=function(d,b,c,k){for(var f={},e={},g=0;g<this._records.length;++g)try{var h=this._records[g],m=a.fsid(h.target);if(m)switch(f[m]=h.target,h.type){case "childList":if(0<h.removedNodes.length)for(var q=0;q<h.removedNodes.length;++q){var t=a.mirrorFor(h.removedNodes[q]);t&&t.id&&t.parent==a.mirrorFor(h.target)&&t.next==a.mirrorFor(h.nextSibling)&&this.genRemove(d,b,t)}m&&(e[m]=h.target);break;case "characterData":var s=
h.target.textContent;h.oldValue!=s&&(a.isBlocked(h.target)||(k[m]=s));break;case "attributes":var v=h.attributeName;h.target.hasAttribute(v)?(s=h.target.getAttribute(v),h.oldValue!=s&&(s=this.rewriteAttr(h.target,v,s),null!==s&&(c[m+":"+v]=s))):c[m+":"+v]=null}}catch(r){}for(var A in e)c=e[A],(k=a.mirrorFor(c))&&k.id&&this.diff(d,b,c,k.child,c.firstChild);for(A in f)c=f[A],this.maybeAddPlaceholderResize(d,b,c)};e.prototype.diff=function(d,b,c,k,f){for(;k&&f;){var e=a.mirrorFor(f);a.fsid(f)?k.id==
e.id?(k=k.next,f=f.nextSibling):(this.genRemove(d,b,k),k=k.next):(this.genInsert(d,b,c,f,k.node),f=f.nextSibling)}for(;k;k=k.next)this.genRemove(d,b,k);for(;f;f=f.nextSibling)this.genInsert(d,b,c,f,null)};e.prototype.maybeAddPlaceholderResize=function(d,b,c){try{for(;c&&!a.fsid(c);)c=c.parentNode;if(c&&a.isBlocked(c)){var k=c.getBoundingClientRect(),f=Math.floor(k.width),e=Math.floor(k.height);b.push({When:d,Kind:a.EVENT_PLACEHOLDER_SIZE,Args:[a.fsid(c),f,e]})}}catch(g){}};e.prototype.genInsert=function(d,
b,c,k,f){var e=this;if(c&&a.isBlocked(c))return null;k=this._encoder.tokenizeNode(c,f,k,function(a){e._visitor(d,a)});0<k.length&&b.push({When:d,Kind:a.EVENT_MUT_INSERT,Args:[a.fsid(c)||-1,a.fsid(f)||-1,this._lz.encode(k)]})};e.prototype.genRemove=function(d,b,c){var k=c.id;this._encoder.removeMirror(c);if(0<b.length&&(c=b[b.length-1],c.Kind==a.EVENT_MUT_REMOVE)){c.Args.push(k);return}b.push({When:d,Kind:a.EVENT_MUT_REMOVE,Args:[k]})};e.prototype.rewriteAttr=function(d,b,c){switch(b){case "style":a.isBlocked(d)&&
(c=this._blocker.mungeBlockedStyle(d,c));break;case "class":a.isBlocked(d)&&0>c.indexOf("_fs_block_")&&(d=a.blockKind(d),c+=" _fs_block_"+d);break;case "value":a.isBlocked(d)&&(c=null)}return c};return e}();a.MutationHandler=g})(h||(h={}));(function(a){var g=function(){function a(b,c,d){this._ctx=b;this._q=c;this._valueIndices=d;this._evts=[]}a.prototype.add=function(a){0==this._evts.length&&this._q.push(a);this._evts.push(a)};a.prototype.finish=function(a,c){var d=this._evts.length;if(1>=d)return!1;
for(var f=this._evts[0].When,e=this._evts[d-1].When,g=0;g<this._valueIndices.length;++g){var h=this._valueIndices[g],m=this._evts[0].Args[h],q=(this._evts[1].When-f)/(e-f),t=(this._evts[1].Args[h]-m)/q,s=this._evts[d-1].Args[h],q=(e-this._evts[d-2].When)/(e-f);c.push(m,s,t,(s-this._evts[d-2].Args[h])/q)}this._evts[0].Kind=a;this._evts[0].Args=c;return!0};a.prototype.evts=function(){return this._evts};return a}(),e=function(){function d(a,c){this._ctx=a;this._blocker=c;this._gotInitialScroll=!1}d.prototype.processQueue=
function(b){if(0==b.length)return b;this.maybeAddInitialScroll();for(var c=this._ctx.now(),d=[],f=new g(this._ctx,d,[0,1]),e={},h={},w,m=0;m<b.length;++m){var q=b[m];switch(q.Kind){case a.EVENT_MOUSEMOVE:f.add(q);break;case a.EVENT_TOUCHMOVE:var t=q.Args[0];t in e||(e[t]=new g(this._ctx,d,[1,2]));e[t].add(q);break;case a.EVENT_SCROLL:t=q.Args[0];t in h||(h[t]=new g(this._ctx,d,[1,2]));h[t].add(q);break;case a.EVENT_INNERWIDTH:w||(w=new g(this._ctx,d,[0]));w.add(q);break;default:d.push(q)}}f.finish(a.EVENT_MOUSEMOVE_CURVE,
[c])&&(b=f.evts(),f=b[b.length-1].Args,2<f.length&&f[2]&&b[0].Args.push(f[2]));for(t in h)b=parseInt(t),h[b].finish(a.EVENT_SCROLL_CURVE,[c,b]);for(t in e)b=parseInt(t),e[b].finish(a.EVENT_TOUCHMOVE_CURVE,[c,b]);w&&w.finish(a.EVENT_INNERWIDTH_CURVE,[c]);return d};d.prototype.maybeAddInitialScroll=function(){!this._gotInitialScroll&&(document.body&&a.fsid(document.body))&&(this._ctx.addWindowScroll(),this._gotInitialScroll=!0)};return d}();a.EventProcessor=e})(h||(h={}));(function(a){var g=function(){function e(a){this._queue=
a;this._overflow=this._enabled=!1;this._total=0}e.prototype.enable=function(){var d=this;d._enabled||(d._enabled=!0,window.console?(console.log&&console.log.apply&&(d._oldLog=console.log,console.log=a.$entry(function(){d.addLog("log",arguments);return d._oldLog.apply(this,arguments)})),console.info&&console.info.apply&&(d._oldInfo=console.info,console.info=a.$entry(function(){d.addLog("info",arguments);return d._oldInfo.apply(this,arguments)})),console.warn&&console.warn.apply&&(d._oldWarn=console.warn,
console.warn=a.$entry(function(){d.addLog("warn",arguments);return d._oldWarn.apply(this,arguments)})),console.error&&console.error.apply&&(d._oldError=console.error,console.error=a.$entry(function(){d.addLog("error",arguments);return d._oldError.apply(this,arguments)}))):d.addLog("log",["NOTE: Log messages cannot be captured on IE9"]),d._oldOnError=window.onerror,window.onerror=function(a,c,e){d.addError(a,c,e);if(d._oldOnError)return d._oldOnError.apply(this,arguments)})};e.prototype.disable=function(){this._enabled&&
(this._enabled=!1,this._oldLog&&(console.log=this._oldLog),this._oldInfo&&(console.info=this._oldInfo),this._oldWarn&&(console.warn=this._oldWarn),this._oldError&&(console.error=this._oldError),window.onerror=this._oldOnError)};e.prototype.addLog=function(d,b){if(this.checkOverflow()){for(var c=[d],e=0;e<b.length;++e)c.push(a.stringify(b[e]));this._queue.enqueue(a.EVENT_LOG,c)}};e.prototype.addError=function(d,b,c){this.checkOverflow()&&this._queue.enqueue(a.EVENT_ERROR,[d,b,c])};e.prototype.checkOverflow=
function(){if(this._overflow)return!1;if(this._total==a.MAX_LOGS_PER_PAGE)return this._queue.enqueue(a.EVENT_LOG,["warn",e.OVERFLOW_MSG]),this._overflow=!0,!1;this._total++;return!0};e.OVERFLOW_MSG='"[received more than '+a.MAX_LOGS_PER_PAGE+' messages; no longer recording console]"';return e}();a.ConsoleHook=g})(h||(h={}));(function(a){a.UID_COOKIE="fs_uid";var g=function(){function e(d,b){this._host=d;this._orgId=b;this._appKey=this._sessionId=this._userId="";this._poisoned=!1;this._cookies={};
for(var c=document.cookie.split(";"),e=0;e<c.length;e++){var f=c[e].replace(/^\s+|\s+$/g,"").split("=");this._cookies[f[0]]=f[1];"Y677"==b&&a.log("debug",b+": host "+d+", location host="+window.location.host+", cookie "+f[0]+"="+f[1])}if(c=this._cookies[a.UID_COOKIE])e=c.split("`"),3>e.length?this._userId=this._cookies[a.UID_COOKIE]:e[0]==this._host&&e[1]==this._orgId?(this._userId=e[2],5<=e.length&&(this._appKey=decodeURIComponent(e[3]),this._poisoned="true"==e[4])):"Y677"==b&&a.log("debug",b+": mismatch, host "+
d+", location host="+window.location.host+", msiod "+this._cookies[a.UID_COOKIE]);e=this._userId.indexOf(":");-1!=e&&(this._sessionId=this._userId.slice(e+1),this._userId=this._userId.slice(0,e));"Y677"==b&&a.log("debug",b+': userid set to "'+this._userId+'" from "'+c+'"')}e.prototype.host=function(){return this._host};e.prototype.orgId=function(){return this._orgId};e.prototype.userId=function(){return this._userId};e.prototype.sessionId=function(){return this._sessionId};e.prototype.appKey=function(){return this._appKey};
e.prototype.poisoned=function(){return this._poisoned};e.prototype.cookies=function(){return this._cookies};e.prototype.setCookie=function(a,b){var c=a+"="+b,c=this._domain?c+("; domain=."+encodeURIComponent(this._domain)):c+"; domain=";document.cookie=c+"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/"};e.prototype.setIds=function(a,b,c){if("localhost"==a||"127.0.0.1"==a)a="";this._domain=a;this._userId=b;this._sessionId=c;this.write()};e.prototype.setAppId=function(d){if(!d)return this._poisoned?
(a.logIfDebug("blocking FS.setUserVars API call due to mismatched user ID"),!1):!0;if(this._appKey&&this._appKey!=d)return a.logIfDebug("blocking FS.identify API call; existing uid ("+this._appKey+") does not match provided uid ("+d+")"),this._poisoned=!0,this.write(),!1;this._appKey=d;this._poisoned=!1;this.write();return!0};e.prototype.write=function(){if(null!=this._domain){var d=this._host+"`"+this._orgId+"`"+this._userId+":"+this._sessionId;this._appKey&&(d+="`"+encodeURIComponent(this._appKey)+
"`"+this._poisoned);this.setCookie(a.UID_COOKIE,d)}};return e}();a.Identity=g})(h||(h={}));(function(a){function g(){return window[e]}var e="_fs_loaded",d;a.Namespace=function(){d||(d=g()?g():window._fs_namespace?window._fs_namespace:"FS");return d};a.isLoaded=g;a.setLoaded=function(a){window[e]=a;a in window||(window[a]={})}})(h||(h={}));(function(a){var g=function(){function e(d,b){var c=this;this._queue=d;this._identity=b;this.AccountSystemVars={acctId:"str",displayName:"str",website:"str"};this.UserSystemVars=
{uid:"str",displayName:"str",email:"str"};this.VarTypes={str:function(a){return"string"==typeof a},bool:function(a){return"boolean"==typeof a},"int":function(a){return"number"==typeof a&&0==a-Math.floor(a)},real:function(a){return"number"==typeof a},date:function(a){return a?!isNaN(a.constructor===Date?a:new Date(a)):!1}};this._apiImpl=a.$entry(function(b,d){switch(b){case "account":if(c._identity.poisoned()){a.logIfDebug("blocking FS.identifyAccount API call due to mismatched user ID");break}c.setvar_api("acct",
c.AccountSystemVars,d);break;case "user":if(!c._identity.setAppId(d.uid))break;c.setvar_api("user",c.UserSystemVars,d);break;default:a.logIfDebug('invalid operation "'+b+'"; only "account" and "user" are supported at present')}})}e.prototype.api=function(a,b){this._apiImpl(a,b)};e.prototype.processApiQueue=function(a){if(a)for(var b=0;b<a.length;b++)this.api(a[b][0],a[b][1])};e.prototype.setvar_api=function(d,b,c){var e={},f;for(f in c)if(c.hasOwnProperty(f)){var g=c[f];a.logIfDebug("set-var('"+d+
"'): \""+f+'" = '+a.stringify(g));var h=typeof g;if("object"!==h||g&&g.constructor==Date){var w,m;if(f in b)w=f,m=b[f];else{m=f.split("_");if(2!=m.length){a.logIfDebug('variables must be of the form "name_type", where "type" is one of [str, bool, int, real, date]');this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvarname",d+":"+f]);continue}-1!=f.indexOf(" ")?(w=f.replace(/ /g,""),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvarname",d+":"+f]),a.logIfDebug("Warning: variable '"+f+"' has spaces in it, which is disallowed. Converted name to '"+
w+"'.")):w=f;m=m[1]}m in this.VarTypes?this.VarTypes[m](g)?("str"==m&&(g=(g=/\b.*\b/g.exec(g))?g[0]:""),"date"==m&&(g=this.toIsoString(g)),e[w]=g):(a.logIfDebug("illegal value "+a.stringify(g)+" for type "+m),"number"===h?h=0==g-Math.floor(g)?"integer":"real":"object"==h&&(null!=g&&g.constructor==Date)&&(h=isNaN(g)?"invalid date":"date"),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvartype",d+":"+f,h])):(a.logIfDebug('invalid type "'+m+'"'),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvarname",
d+":"+f]))}else g instanceof Array&&(h="array"),this._queue.enqueue(a.EVENT_SYS_HIGHLIGHT,["badvartype",d+":"+f,h+" (unsupported)"])}this._queue.enqueue(a.EVENT_SYS_SETVAR,[d,a.stringify(e)])};e.prototype.toIsoString=function(a){return(a.constructor===Date?a:new Date(a)).toISOString()};return e}();a.Vars=g})(h||(h={}));(function(a){function g(b,c,d,e){void 0===e&&(e=null);b="//"+u.host()+b;var f=null;null!=c&&(f=a.stringify(c),N+=f.length,a.logIfDebug("total bytes written: "+N));var g=new XMLHttpRequest;
if("withCredentials"in g)g.onreadystatechange=function(){g.readyState==a.XHR_DONE&&(200==g.status?d(g.responseText):e(g.status))},g.open("POST",G+b,!0),g.withCredentials=!0,g.setRequestHeader("Content-Type","text/plain"),g.send(f);else{var h=new XDomainRequest;h.onload=function(){d(h.responseText)};h.onerror=function(){e("Not Found"==h.responseText?404:500)};h.onprogress=function(){};h.open("POST",b);h.send(f)}}function e(){if("baseURI"in document)return document.baseURI;var a=document.getElementsByTagName("base")[0];
return a&&a.href?a.href:location.href}function d(a){(a=a.target.tagName)&&(a=a.toLowerCase());return a}function b(a,c){return a.tagName&&a.tagName.toLowerCase()in c?!0:a.parentNode?b(a.parentNode,c):!1}function c(a,b){if(void 0!==a.changedTouches)for(var c=0;c<a.changedTouches.length;++c){var d=a.changedTouches[c];isNaN(parseInt(d.identifier))&&(d.identifier=0);n.enqueue(b,[d.identifier,d.clientX,d.clientY])}}function h(){var a=document.activeElement;a&&H.invokeGlobalOnChange(a)}function f(){var b=
window.innerWidth;b!=$&&(n.enqueue(a.EVENT_INNERWIDTH,[b]),$=b)}function p(b,c){b in O||(O[b]=setTimeout(function(){delete O[b];c()},a.ScrollSampleInterval))}function l(){var b=a.fsid(document.body);b&&p(b,function(){var c,d;"pageXOffset"in window?(c=window.pageXOffset,d=window.pageYOffset):(c=document.body.scrollLeft,d=document.body.scrollTop);if(c!=aa||d!=ba)n.enqueue(a.EVENT_SCROLL,[b,c,d]),aa=c,ba=d;f()})}function w(b){var c=b.target,d=a.fsid(c);d&&p(d,function(){n.enqueue(a.EVENT_SCROLL,[d,c.scrollLeft,
c.scrollTop])})}function m(){ca?n.enqueue(a.EVENT_RESIZE,[document.body.clientWidth,document.body.clientHeight]):n.enqueue(a.EVENT_RESIZE,[document.documentElement.clientWidth,document.documentElement.clientHeight])}function q(){var b=location.href;P!=b&&(P=b,n.enqueue(a.EVENT_NAVIGATE,[location.href,document.title]))}function t(b){var c=a.fsidIfNotBlocked(b);c&&n.enqueue(a.EVENT_VALUECHANGE,[c,a.valueOfInputishElem(b)])}function s(b){u.setIds(b.CookieDomain,b.UserIntId,b.SessionIntId);Q=b.PageIntId;
da=b.EmbedToken;a.logIfDebug("/User,"+u.userId()+"/Session,"+u.sessionId()+"/Page,"+Q)}function v(a){if(I&&a){var b=document.createElement("script");b.text=a;b.async=!0;document.head.appendChild(b)}}function r(){var a=document.doctype;if(!a)return null;var b;b="<!DOCTYPE "+a.name;a.publicId&&(b+=' PUBLIC "'+a.publicId+'"');a.systemId&&(b+=' "'+a.systemId+'"');return b+">"}function A(){var b=document.documentElement,c=window._fs_hash,d=window._fs_replay_flags;P=location.href;if(J)b={OrgId:u.orgId(),
UserId:u.userId(),Url:location.href,Base:e(),ScreenWidth:window.screen.width,ScreenHeight:window.screen.height,Width:b.clientWidth,Height:b.clientHeight,Referrer:document.referrer,Doctype:r(),Hash:c},d&&(b.ReplayFlags=d),g(R+"/page",b,function(b){try{var c=a.parseJson(b)}catch(d){z();return}b=c;s(b);S=b.IntegrationScript;v(b.IntegrationScript);if(window._fs_ready)try{window._fs_ready()}catch(e){a.logIfDebug("exception in _fs_ready(): "+e)}for(b=0;b<c.Blocks.length;++b)try{a.BlockRule.isComment(c.Blocks[b].Selector)||
y.addRule(c.Blocks[b])}catch(f){a.logIfDebug("Unexpected error parsing block rule. Skipping "+c.Blocks[b])}n.startPipeline()},function(a){z()});else{a.logIfDebug("Unable to record playback stream.");var f=document.createElement("script");window.__fs_startResponse=function(a){s(a);S=a.IntegrationScript;v(a.IntegrationScript);document.body.removeChild(f)};f.src="//"+u.host()+R+"/page?OrgId="+u.orgId()+"&UserId="+u.userId()+"&Url="+encodeURIComponent(location.href)+"&Base="+encodeURIComponent(e())+"&ScreenWidth="+
window.screen.width+"&ScreenHeight="+window.screen.height+"&Width="+b.clientWidth+"&Height="+b.clientHeight+"&Referrer="+encodeURIComponent(document.referrer)+"&Doctype="+encodeURIComponent(r())+"&Fallback=true"+(d?"&ReplayFlags="+d:"")+(c?"&Hash="+c:"");document.body.appendChild(f)}}function z(){n.disableRecording();ea();a.logIfDebug("Disabling FS.");if(window._fs_ready)try{window._fs_ready(!0)}catch(b){a.logIfDebug("exception in _fs_ready(): "+b)}}function qa(){fa.hookMutations();document.documentElement.addEventListener("scroll",
function(a){w(a)},!0);window.addEventListener("mousemove",function(b){b=a.fsid(b.target)?[b.clientX,b.clientY,a.fsid(b.target)]:[b.clientX,b.clientY];n.enqueue(a.EVENT_MOUSEMOVE,b)},!0);window.addEventListener("mousedown",function(c){n.enqueue(a.EVENT_MOUSEDOWN,[c.clientX,c.clientY]);!b(c.target,{button:!0,a:!0,input:!0})||"input"==d(c)&&"submit"!=c.target.type||n.swanSong()},!0);window.addEventListener("mouseup",function(b){n.enqueue(a.EVENT_MOUSEUP,[b.clientX,b.clientY])},!0);window.addEventListener("keydown",
function(b){var c=document.activeElement;if(!c||a.fsidIfNotBlocked(c))h(),n.enqueue(a.EVENT_KEYDOWN,[b.keyCode]);switch(d(b)){case "button":13!=b.keyCode&&32!=b.keyCode||n.swanSong();break;case "a":13==b.keyCode&&n.swanSong();break;case "input":"submit"==b.target.type&&13==b.keyCode&&n.swanSong()}},!0);window.addEventListener("keyup",function(b){var c=document.activeElement;if(!c||a.fsidIfNotBlocked(c))h(),n.enqueue(a.EVENT_KEYUP,[b.keyCode])},!0);window.addEventListener("scroll",function(a){l()});
window.addEventListener("resize",function(a){m()});window.addEventListener("submit",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_FORM_SUBMIT,[b])});document.body.addEventListener("click",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_CLICK,[b])},!0);document.body.addEventListener("dblclick",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_DBL_CLICK,[b])},!0);document.body.addEventListener("focus",function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_FOCUS,[b])},!0);document.body.addEventListener("blur",
function(b){(b=a.fsid(b.target))&&n.enqueue(a.EVENT_BLUR,[b])},!0);document.body.addEventListener("change",function(a){t(a.target)},!0);window.addEventListener("touchstart",function(b){c(b,a.EVENT_TOUCHSTART);l()},!0);window.addEventListener("touchend",function(b){c(b,a.EVENT_TOUCHEND);l()},!0);window.addEventListener("touchmove",function(b){c(b,a.EVENT_TOUCHMOVE);l()},!0);window.addEventListener("touchcancel",function(b){c(b,a.EVENT_TOUCHCANCEL)},!0);window.addEventListener("play",function(b){var c=
a.EVENT_PLAY;(b=a.fsid(b.target))&&n.enqueue(c,[b])},!0);window.addEventListener("pause",function(b){var c=a.EVENT_PAUSE;(b=a.fsid(b.target))&&n.enqueue(c,[b])},!0);window.addEventListener("focus",function(b){n.enqueue(a.EVENT_WINDOW_FOCUS,[])},!1);window.addEventListener("blur",function(b){n.enqueue(a.EVENT_WINDOW_BLUR,[])},!1);H.hookEvents();if(history.pushState){window.addEventListener("popstate",function(){q()});var e=history.pushState;history.pushState=function(a,b,c){e.call(this,a,b,c);q()};
var f=history.replaceState;history.replaceState=function(a,b,c){f.call(this,a,b,c);q()}}}function M(){T.enable()}function X(){T.disable()}function Y(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];"log"!==a&&("info"!==a&&"warn"!==a&&"error"!==a&&"debug"!==a)&&(b.unshift(a),a="log");T.addLog(a,b)}function Z(){if("_fs_host"in window||"_fs_ext_host"in window)if("_fs_org"in window||"_fs_ext_org"in window){"_fs_ext_debug"in window?K=!!window._fs_ext_debug:"_fs_debug"in window&&(K=!!window._fs_debug);
var b=window._fs_ext_host||window._fs_host,c=window._fs_ext_org||window._fs_org;a.logIfDebug("host: "+b);a.logIfDebug("orgid: "+c);M();u=new a.Identity(b,c);U=new a.Vars(n,u);0==b.indexOf("localhost")&&(G="");ca="BackCompat"==document.compatMode;ga=!!window._fs_is_outer_script;x=B()?null:0;J=!!window.MutationEvent;B()?window._fs_run_in_iframe?parent.postMessage?ra():(J=!1,a.logIfDebug("postMessage not supported")):a.logIfDebug("Fullstory recording for this page is NOT allowed within an iFrame."):
(y.addRule({Selector:"object",Kind:a.NYI_KIND}),y.addRule({Selector:"embed",Kind:a.NYI_KIND}),y.addRule({Selector:"canvas",Kind:a.NYI_KIND}),y.addRule({Selector:"noscript",Kind:a.BLOCKED_KIND}),y.addRule({Selector:".fs-hide",Kind:a.HIDE_KIND}),U.processApiQueue(window[a.Namespace()].q),delete window[a.Namespace()].q,A())}else a.logIfDebug("Missing global _fs_org. Recording disabled.");else a.logIfDebug("Missing global _fs_host. Recording disabled.")}function D(){return(new Date).getTime()}function B(){return window!=
top&&!ga}function sa(){var b=function(){I||(I=!0,n.enqueue(a.EVENT_DOMLOADED,[]),qa(),m(),v(S))},c=!1,d=function(){c||(c=!0,n.enqueue(a.EVENT_LOAD,[]))};switch(document.readyState){case "interactive":document.attachEvent||b();break;case "complete":b(),d()}I||document.addEventListener("DOMContentLoaded",function(a){b()});c||window.addEventListener("load",function(a){b();d()});B()||(window.addEventListener("beforeunload",function(a){n.addUnload()}),window.addEventListener("unload",function(a){n.addUnload()}))}
function ha(){J&&(n.recoverSwanSong(),E=D(),sa())}function ia(a,b){U.api(a,b)}function ja(b,c,d){b&&"string"==typeof b?c&&"string"!=typeof c?a.logIfDebug("setUid(): second argument (display name) must be a string"):(c||(c=b),d&&"object"!=typeof d?a.logIfDebug('setUid(): third argument (metadata) must be of the form {name0: "value0", name1: "value1", ...}'):(d=d?a.stringify(d):"",a.logIfDebug("setting uid: "+b+", meta: "+d),n.enqueue(a.EVENT_SYS_SETMETA,[b,c,d]))):a.logIfDebug("setUid(): first argument (user id) is required and must be a string")}
function ka(){var a=V();return a?G+"//"+u.host()+"/ui/"+u.orgId()+"/session/"+encodeURIComponent(a):null}function V(){return u.userId()?u.userId()+":"+u.sessionId():null}function la(){return u.cookies()}function ma(a,b){return u.setCookie(a,b)}function ra(){window.addEventListener("message",function(b){if("string"==typeof b.data&&0==b.data.indexOf(a.FS_MESSAGE_PREFIX)){var c=b.data.split(a.FS_DELIMITER);if(c[0]==a.FS_SET_FRAME_ID_CMD)try{var d=parseInt(c[1]),e=a.parseJson(c[2]),f=parseInt(c[3]);var g=
a.parseJson(c[4]);if(d)if(x)a.logIfDebug("frame Id is already set to "+x+". Received second request to set it to "+d+" Iframe:"+location.href);else{a.logIfDebug("FrameId received within frame "+location.href+": "+d);x=d;L=e;for(c=0;c<g.length;++c)y.addRule(g[c]);n.rebaseIframe(f,r());E=f;n.startPipeline();if(0<F.length){for(c=0;c<F.length;c++)F[c]();F=[]}}else a.logIfDebug("Outer page gave us a bogus frame Id! Iframe: "+location.href)}catch(h){a.logIfDebug("Failed to parse frameId from message"+b.data)}else c[0]==
a.FS_DISABLE_RECORDING?(n.disableRecording(),ea()):b.source==parent&&a.logIfDebug("Invalid _fs postmessage command: "+c[0])}});x||(0==x?a.logIfDebug("For some reason the outer window attempted to request a frameId"):(a.logIfDebug("Asking for a frame ID from within frame: "+location.href),parent.postMessage(a.FS_REQUEST_FRAME_ID+a.FS_DELIMITER,"*")))}function ea(){for(var b=0;b<C.length;b++){var c=C[b];c.contentWindow&&c.contentWindow.postMessage&&c.contentWindow.postMessage(a.FS_DISABLE_RECORDING,
"*")}}function ta(){window.addEventListener("message",function(b){if("string"==typeof b.data&&0==b.data.indexOf(a.FS_MESSAGE_PREFIX)){var c=b.data.split(a.FS_DELIMITER);if(c[0]==a.FS_IFRAME_EVENTS)b=a.parseJson(c[1]),0<b.length&&(B()?n.appendToQueue(b):n.appendToOutgoingQueue(b));else{var d;a:{d=b.source;for(var e=0;e<C.length;e++)if(C[e].contentWindow==d){d=a.fsid(C[e]);break a}a.logIfDebug("Unable to locate frame for window");d=NaN}c[0]==a.FS_REQUEST_FRAME_ID?b.source&&d?(a.logIfDebug("Responding to FID request for frame "+
d),na(b.source,d)):a.logIfDebug("No FrameId found. Hoping to send one later."):B()||a.logIfDebug("Invalid _fs postmessage command: "+c[0]+" sent from child FrameId: "+d)}}})}function na(b,c){var d=function(){var d=a.stringify(y.rawRules),e=[];0!=x&&(e=L?L.concat(x):[x]);b.postMessage(a.FS_SET_FRAME_ID_CMD+a.FS_DELIMITER+c+a.FS_DELIMITER+a.stringify(e)+a.FS_DELIMITER+E+a.FS_DELIMITER+d,"*")};null==x?F.push(d):d()}function oa(b){a.logIfDebug("Injecting into Frame ["+b.src+"]");try{if(b.src&&("about:blank"!=
b.src&&0>b.src.indexOf("javascript:"))&&b.src!=b.contentWindow.location.href)a.logIfDebug("Frame not yet loaded: "+b.src);else if(b.contentWindow[a.Namespace()])a.logIfDebug("FS already defined in Frame contentWindow: "+b.src+". Ignoring.");else{var c=b.contentDocument,d="var _fs_org='"+u.orgId()+"', _fs_host='"+u.host()+"', _fs_run_in_iframe=true, _fs_debug="+K+"; (function(w,a,t){a=w.createElement('script');a.async=1;a.src='"+G+"//'+_fs_host+'/s/fs.js';w.head.appendChild(a)})(document);",e=c.createElement("script");
e.textContent=d;c.head.appendChild(e)}}catch(f){a.logIfDebug("iFrame no injecty. Probably not same origin.")}}function ua(b,c){C.push(c);va(c)?(a.logIfDebug("Attempting to setup Frame ["+c.src+"]"),oa(c),c.addEventListener("load",function(b){a.logIfDebug("onload for frame ["+c.src+"]");oa(c)})):(a.logIfDebug("Frame Doesn't need injecting. Probably cross domain ["+c.src+"]"),c.contentWindow.postMessage&&(a.logIfDebug("Eagerly sending FrameId "+b+" to Frame ["+c.src+"]"),na(c.contentWindow,b)))}function va(a){var b=
a.src;return!a.hasAttribute("src")||"about:blank"==b||0==b.indexOf("javascript:")||0==b.indexOf(wa)}a.Setup=function(){if(!a.isLoaded()){var b=a.Namespace();a.setLoaded(b);window[b].setUid=a.$entry(ja);window[b].getCurrentSessionURL=a.$entry(ka);window[b].getCurrentSession=a.$entry(V);window[b].enableConsole=a.$entry(M);window[b].disableConsole=a.$entry(X);window[b].log=a.$entry(Y);window[b]._api=ia;window[b]._cookies=la;window[b]._setCookie=ma;Z();ha()}};var K=!1,N=0,Q,x,L,wa=window.location.protocol+
"//"+window.location.host,ga,J,E=D(),P,I=!1,S=null,pa,aa=-1,ba=-1,$=0,O={},da,ca=!1,G="https:",W={startTime:function(){return E},now:function(){return D()-E},wallTime:D,orgId:function(){return u.orgId()},userId:function(){return u.userId()},sessionId:function(){return u.sessionId()},pageId:function(){return Q},baseUri:e,amInsideIFrame:B,frameId:function(){return x},parentIds:function(){return L},post:g,addWindowScroll:l},R=0>D()%1E3?"/recvm":"/rec",y=new a.Blocker,H=new a.InputWatcher(function(a){t(a)},
function(b){return!!a.fsid(b)}),fa=new a.MutationHandler(W,y,function(b,c){switch(c.nodeName){case "INPUT":case "TEXTAREA":case "SELECT":H.addInput(c);break;case "FRAME":case "IFRAME":var d=a.fsid(c);if(!d){a.logIfDebug("fsid missing or invalid for iFrame."+c.src);break}pa||(ta(),pa=!0);ua(d,c);break;case "VIDEO":case "AUDIO":c.paused||(d=a.fsid(c),n.enqueue(a.EVENT_PLAY,[d]))}}),xa=new a.EventProcessor(W,y),n=new a.EventQueue(W,R,xa,fa,function(){H.tick();f()}),T=new a.ConsoleHook(n),u,U;window._fs_shutdown=
function(a){n.shutdown();a&&(a=document.getElementById(a))&&a.setAttribute("_fs_embed_token",da)};a.enableConsole=M;a.disableConsole=X;a.log=Y;a._init=Z;a._record=ha;a.isDebug=function(){return K};a._api=ia;a.setUid=ja;a.getCurrentSessionURL=ka;a.getCurrentSession=V;a._cookies=la;a._setCookie=ma;a.FS_MESSAGE_PREFIX="_fs";a.FS_DELIMITER="{\uffff}";a.FS_REQUEST_FRAME_ID=a.FS_MESSAGE_PREFIX+"RequestFrameId";a.FS_SET_FRAME_ID_CMD=a.FS_MESSAGE_PREFIX+"SetFrameId";a.FS_IFRAME_EVENTS=a.FS_MESSAGE_PREFIX+
"EvtBundle";a.FS_DISABLE_RECORDING=a.FS_MESSAGE_PREFIX+"DisableRecording";var C=[],F=[]})(h||(h={}));try{h.Setup()}catch(z){window.console&&console.log&&console.log("Failed to initialize FullStory.")}})();
